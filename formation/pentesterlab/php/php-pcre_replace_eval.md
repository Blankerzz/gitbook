# PHP - PCRE\_REPLACE\_EVAL

Another very dangerous modifier exists in PHP: PCRE\_REPLACE\_EVAL (/e).

This modifier will cause the function `preg_replace` to evaluate the new value as PHP code, before performing the substitution.\
PCRE\_REPLACE\_EVAL has been deprecated as of PHP 5.5.0

Here, you will need to change the pattern, by adding the /e modifier. Once you have added this modifier, you should get a notice:

Notice: Use of undefined constant hacker - assumed 'hacker' in /var/www/codeexec/example3.php(3) : regexp code on line 1

The function preg\_replace tries to evaluate the value hacker as a constant, but as it is not defined, you get this error message.

You can easily replace hacker with a call to the function phpinfo() to get a visible result.

Once you can see the result of the phpinfo function, you can use the function system to run any command.

`payload : index.php?pat=`**/a/e**`&rep=`**system('/usr/local/bin/score 44073236-f0a6-4005-bb2f-9307b4fcd1a4â€™**`, $return_var`**);**`&sub=`**abc**
