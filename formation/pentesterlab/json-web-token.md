# JSON WEB TOKEN

Un JSON Web Token est fourni à l’utilisateur via un cookie lors de l’authentification

JWT fourni les mécanisme de sécurité suivant : Encryptions et Signature.

### Composition <a href="#jsonwebtoken-composition" id="jsonwebtoken-composition"></a>

JWT est composé du pattern suivant :

`Base64(Header).Base64(Data).Base64(Signature)`

Le Header contient les information sur le mécanisme de sécurité utilisé.

Pour exemple le Header suivant : `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXUyJ9` contient ces informations :

`{ "alg": "HS256",`\
`"typ": "JWS"}`

Le Header vérifiera la signature et la signature vérifiera le Header.

Signer le Header n’empêchera pas un hacker de le falsifier et de changer l’algorithme utilisé pour la signature.

### Vulnérabilité <a href="#jsonwebtoken-vulnerabilite" id="jsonwebtoken-vulnerabilite"></a>

origine : [https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/.](https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/)

Plusieurs type de signature peuvent assuré l’intégrité d’un JWT :

* RSA based
* Elliptic curves
* HMAC
* None

Comme SSL (avec le NULL Cipher) JWT supporte les algorithmes de Signature None (vide).

Probablement introduit pour débugger l’application, Cependant peut avoir un impact sur la sécurité.

### Exploitation <a href="#jsonwebtoken-exploitation" id="jsonwebtoken-exploitation"></a>

Pour Exploiter cette vulnérabilité, nous avons besoin de décoder le JWT et de changer son algorithme utilisé pour la signature.

Cependant cela ne fonctionnera pas si nous n’enlevons pas la signature.

Ainsi en fournissant une signature avec le `None` algorithme nous nous assurons que la signature renseigné soit vide.

POC :

pour le JWT suivant :

`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXUyJ9.eyJsb2dpbiI6IkFwbyIsImlhdCI6IjE2NzYwMzQ5NjQifQ.MzIwMjQ2MjBlYjI5OWFmNDM4NGM1NGQxZjkwNGViZmExZjI0YzYyOWY5OTY1MTc2YWMzZDdlMTEwNzNjNDFhZQ`

décodé en Base64 :

`{"alg":"HS256","typ":"JWS"}.{"login":"Apo","iat":"1676034964"fQ.32024620eb299af4384c54d1f904ebfa1f24c629f9965176ac3d7e11073c41aZQ`

on modifie

`{"alg":"HS256","typ":"JWS"}` en `{"alg":"None","typ":"JWS"}`

et on change le paramètre de la data

`{"login":"admin","iat":"1676034964"`}

puis on encode en Base64 sans mettre de signature.
